<% provide(:title, @title) %> <h1><%= @header %></h1>

<!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
<div id="player_wrapper">
	<div id="player"></div>

	<script>	
		// 2. This code loads the IFrame Player API code asynchronously.
		var tag = document.createElement('script');

		tag.src = "//www.youtube.com/iframe_api";
		var firstScriptTag = document.getElementsByTagName('script')[0];
		firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

		// 3. This function creates an <iframe> (and YouTube player)
		//    after the API code downloads.
		var player;
		function onYouTubeIframeAPIReady() {
			player = new YT.Player('player', {
				height : '390',
				width : '640',
				videoId : '<%= @default_video %>',
				events : {
					'onReady' : onPlayerReady
				}
			});
			
			// Add click events to each video
			$(".video_link").click(function() {
				playVideo(this);
			});
		}

		// 4. The API will call this function when the video player is ready.
		function onPlayerReady(event) {
			event.target.playVideo();
		}

		function playVideo(video_link) {
			video = $(video_link);
			player.loadVideoById(video.attr('video-id'), 0, "large")
		}
	</script>
</div>
<div id="videos">
	<div class="video-list">
		<div class="video_thumbnail_row">
			<% @videos.each do |video| %>
				<div class="video_link" video-id="<%= video[:id] %>">
					<img src="http://i.ytimg.com/vi/<%= video[:id] %>/default.jpg" alt="<%= video[:title] %>"><br>
					<span class="video_title"><%= video[:title] %></span>
				</div>			
			<% end %>
		</div>						
	</div>	
</div>

<% if signed_in? %>
	<%= render 'shared/disqus' %>
<% end %>